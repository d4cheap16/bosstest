<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BOSS Sprite Previewer</title>
    <style>
        body {
            background-color: #111; color: #ddd; font-family: monospace;
            margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden;
        }
        /* é è¦½å€ */
        #stage {
            flex: 1; display: flex; align-items: flex-end; justify-content: center;
            background: radial-gradient(circle, #222 0%, #000 100%);
            padding-bottom: 50px; border-bottom: 2px solid #500; position: relative;
        }
        /* åœ–ç‰‡æœ¬é«” (åƒç´ é¢¨æ ¼è¨­å®š) */
        #boss-img {
            image-rendering: pixelated; transition: width 0.2s, filter 0.1s;
            width: 150px; /* åˆå§‹å¤§å° */
        }
        /* è³‡è¨Šæ–‡å­— */
        #info { position: absolute; top: 10px; left: 10px; font-size: 12px; color: #666; }
        
        /* æ§åˆ¶å€ */
        #controls {
            background: #222; padding: 15px; border-top: 1px solid #444;
            display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;
        }
        button, label {
            padding: 8px 16px; background: #333; border: 1px solid #555; color: #fff;
            cursor: pointer; font-size: 14px; border-radius: 4px;
        }
        button:hover, label:hover { background: #444; border-color: #888; }
        button:active { transform: scale(0.95); }
        input[type="file"] { display: none; }

        /* ç‰¹æ•ˆå‹•ç•« */
        .shake { animation: shake 0.3s cubic-bezier(.36,.07,.19,.97) both; }
        .flash { filter: brightness(10) sepia(1) hue-rotate(-50deg) saturate(5) !important; }
        
        @keyframes shake {
            10%, 90% { transform: translate3d(-2px, 0, 0); }
            20%, 80% { transform: translate3d(4px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-8px, 0, 0); }
            40%, 60% { transform: translate3d(8px, 0, 0); }
        }
    </style>
</head>
<body>

    <div id="stage">
        <div id="info">Z-Depth: <span id="z-val">0.2</span></div>
        <img id="boss-img" src="boss_idle.png" alt="BOSS" onerror="this.style.opacity=0.3">
    </div>

    <div id="controls">
        <!-- æª”æ¡ˆè¼‰å…¥ -->
        <label>ğŸ“‚ è¼‰å…¥å¾…æ©Ÿåœ– <input type="file" onchange="loadImg(this, 'idle')"></label>
        <label>ğŸ“‚ è¼‰å…¥æ”»æ“Šåœ– <input type="file" onchange="loadImg(this, 'attack')"></label>
        
        <span style="border-left: 1px solid #555; margin: 0 5px;"></span>

        <!-- å‹•ä½œæ¸¬è©¦ -->
        <button onclick="changeZ(0.1)">â« å‰é€²</button>
        <button onclick="changeZ(-0.1)">â¬ å¾Œé€€</button>
        <button onclick="toggleState()" id="btn-state">åˆ‡æ›: å¾…æ©Ÿ</button>
        <button onclick="triggerDamage()" style="color:#f88; border-color:#844">ğŸ’¥ å—å‚·æ¸¬è©¦</button>
    </div>

    <script>
        const imgEl = document.getElementById('boss-img');
        const zEl = document.getElementById('z-val');
        const btnState = document.getElementById('btn-state');
        
        // é è¨­è·¯å¾‘ (å°æ‡‰ GitHub Page æª”æ¡ˆçµæ§‹)
        let srcIdle = "boss_idle.png";
        let srcAttack = "boss_attack.png";
        
        let z = 0.2;
        let isIdle = true;

        // è¼‰å…¥æœ¬åœ°åœ–ç‰‡ (ä¾›å¿«é€Ÿæ¸¬è©¦ç”¨)
        function loadImg(input, type) {
            if (input.files && input.files[0]) {
                const url = URL.createObjectURL(input.files[0]);
                if (type === 'idle') srcIdle = url;
                if (type === 'attack') srcAttack = url;
                updateView();
            }
        }

        // æ¨¡æ“¬ Z è»¸ç§»å‹• (æ”¹è®Šå¤§å°)
        function changeZ(delta) {
            z = Math.max(0.05, Math.min(1.5, z + delta));
            // æ¨¡æ“¬éŠæˆ²å…§çš„é€è¦–å…¬å¼: size = base + (z^2 * scale)
            const width = 50 + (z * z * 400); 
            imgEl.style.width = width + "px";
            zEl.innerText = z.toFixed(2);
        }

        // åˆ‡æ›ç‹€æ…‹
        function toggleState() {
            isIdle = !isIdle;
            btnState.innerText = isIdle ? "åˆ‡æ›: å¾…æ©Ÿ (Idle)" : "åˆ‡æ›: æ”»æ“Š (Attack)";
            updateView();
        }

        // æ›´æ–°åœ–ç‰‡ä¾†æº
        function updateView() {
            imgEl.src = isIdle ? srcIdle : srcAttack;
            imgEl.style.opacity = 1;
        }

        // å—å‚·ç‰¹æ•ˆ
        function triggerDamage() {
            // 1. ç¬é–“åˆ‡æ›åˆ°æ”»æ“Šç‹€æ…‹ (æ¨¡æ“¬ç”Ÿæ°£)
            const oldState = isIdle;
            isIdle = false; 
            updateView();

            // 2. éœ‡å‹• + é–ƒå…‰
            imgEl.classList.add('shake', 'flash');

            // 3. æ¢å¾©
            setTimeout(() => {
                imgEl.classList.remove('shake', 'flash');
                // å¦‚æœåŸæœ¬æ˜¯å¾…æ©Ÿï¼Œ0.5ç§’å¾Œè®Šå›å¾…æ©Ÿ
                if (oldState) {
                    setTimeout(() => { isIdle = true; updateView(); }, 500);
                }
            }, 300);
        }

        // åˆå§‹åŒ–
        changeZ(0); 
    </script>
</body>
</html>
